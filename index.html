<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <meta name="description" content="ProteinValue - Compare protein products by cost per gram">
    <meta name="theme-color" content="#059669">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü•©</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü•©</text></svg>">
    
    <title>ProteinValue - Smart Protein Shopping</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>ü•© ProteinValue</h1>
                <p class="tagline">Compare Products, Maximize Value</p>
            </div>
        </header>

        <!-- Main Layout -->
        <main class="main-layout">
            <!-- LEFT SIDEBAR -->
            <aside class="sidebar" id="sidebar">
                <!-- Step Indicator -->
                <div class="step-indicator">
                    <div class="step active" data-step="1">
                        <span class="step-num">1</span>
                        <span class="step-label">Photos</span>
                    </div>
                    <div class="step-line"></div>
                    <div class="step" data-step="2">
                        <span class="step-num">2</span>
                        <span class="step-label">Details</span>
                    </div>
                    <div class="step-line"></div>
                    <div class="step" data-step="3">
                        <span class="step-num">3</span>
                        <span class="step-label">Compare</span>
                    </div>
                </div>

                <!-- STEP 1: Photo Capture -->
                <div id="step-1" class="step-content">
                    <div class="card">
                        <h2 class="card-title">üì∏ Capture Product Photos</h2>
                        <p class="card-description">Take photos as reference while entering details</p>
                        
                        <!-- Product Photo -->
                        <div class="photo-section">
                            <div class="photo-label">
                                <span class="photo-icon">üì¶</span>
                                <span>Product Front</span>
                                <span class="optional-badge">Optional</span>
                            </div>
                            <div class="photo-capture" id="product-photo-area">
                                <input type="file" id="product-photo-input" accept="image/*" capture="environment" class="hidden">
                                <div class="photo-preview" id="product-photo-preview">
                                    <button type="button" class="capture-btn" id="capture-product-btn">
                                        <span class="btn-icon">üì∑</span>
                                        <span>Take Photo</span>
                                    </button>
                                </div>
                                <img id="product-photo-img" class="captured-photo hidden" alt="Product photo">
                                <button type="button" id="retake-product-btn" class="retake-btn hidden">üîÑ Retake</button>
                            </div>
                        </div>

                        <!-- Nutrition Label Photo -->
                        <div class="photo-section">
                            <div class="photo-label">
                                <span class="photo-icon">üìã</span>
                                <span>Nutrition Label</span>
                                <span class="recommended-badge">Recommended</span>
                            </div>
                            <div class="photo-capture" id="label-photo-area">
                                <input type="file" id="label-photo-input" accept="image/*" capture="environment" class="hidden">
                                <div class="photo-preview" id="label-photo-preview">
                                    <button type="button" class="capture-btn" id="capture-label-btn">
                                        <span class="btn-icon">üì∑</span>
                                        <span>Take Photo</span>
                                    </button>
                                </div>
                                <img id="label-photo-img" class="captured-photo hidden" alt="Nutrition label">
                                <button type="button" id="retake-label-btn" class="retake-btn hidden">üîÑ Retake</button>
                            </div>
                        </div>

                        <div class="photo-tip">
                            üí° Photos help you reference values while entering. You can also skip and enter manually.
                        </div>
                    </div>

                    <div class="step-buttons">
                        <button type="button" class="btn-secondary" id="skip-photos-btn">Skip Photos</button>
                        <button type="button" class="btn-primary" id="next-to-step-2">Next: Enter Details ‚Üí</button>
                    </div>
                </div>

                <!-- STEP 2: Product Details -->
                <div id="step-2" class="step-content hidden">
                    <div class="card">
                        <h2 class="card-title">‚úèÔ∏è Product Details</h2>
                        
                        <!-- Photo Reference (if taken) -->
                        <div id="photo-reference" class="photo-reference hidden">
                            <div class="reference-header">
                                <span>üì∏ Your Photos</span>
                                <button type="button" id="toggle-photos-btn" class="toggle-btn">Hide</button>
                            </div>
                            <div class="reference-images" id="reference-images">
                                <img id="ref-product-img" class="ref-img hidden" alt="Product">
                                <img id="ref-label-img" class="ref-img hidden" alt="Label">
                            </div>
                        </div>

                        <!-- Basic Info -->
                        <div class="form-section">
                            <h3 class="section-title">Basic Info</h3>
                            <div class="input-group">
                                <label>Product Name *</label>
                                <input type="text" id="product-name" placeholder="e.g., Optimum Nutrition Gold Standard Whey" autocomplete="off">
                            </div>
                            
                            <div class="input-group">
                                <label>Brand</label>
                                <input type="text" id="product-brand" placeholder="e.g., Optimum Nutrition" autocomplete="off">
                            </div>

                            <div class="input-group">
                                <label>Protein Source *</label>
                                <select id="protein-source">
                                    <option value="">-- Select Source --</option>
                                    <optgroup label="ü•õ Animal-Based">
                                        <option value="whey">Whey Protein</option>
                                        <option value="whey-isolate">Whey Isolate</option>
                                        <option value="casein">Casein</option>
                                        <option value="egg">Egg White</option>
                                        <option value="beef">Beef</option>
                                        <option value="chicken">Chicken</option>
                                        <option value="fish">Fish</option>
                                        <option value="dairy">Dairy (Milk/Yogurt/Cheese)</option>
                                    </optgroup>
                                    <optgroup label="üå± Plant-Based">
                                        <option value="pea">Pea Protein</option>
                                        <option value="soy">Soy Protein</option>
                                        <option value="rice">Rice Protein</option>
                                        <option value="hemp">Hemp Protein</option>
                                        <option value="peanut">Peanut/Nut Butter</option>
                                        <option value="lentil">Lentil/Legume</option>
                                        <option value="blend-plant">Plant Blend</option>
                                    </optgroup>
                                    <optgroup label="üîÄ Other">
                                        <option value="blend-mixed">Mixed Blend</option>
                                        <option value="collagen">Collagen</option>
                                        <option value="other">Other</option>
                                    </optgroup>
                                </select>
                            </div>
                        </div>

                        <!-- Pricing -->
                        <div class="form-section">
                            <h3 class="section-title">üí∞ Pricing</h3>
                            <div class="input-row">
                                <div class="input-group">
                                    <label>Price ($) *</label>
                                    <input type="number" id="product-price" placeholder="29.99" step="0.01" min="0">
                                </div>
                                <div class="input-group">
                                    <label>Container Size</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="container-size" placeholder="2" step="0.1" min="0">
                                        <select id="container-unit">
                                            <option value="lb">lb</option>
                                            <option value="kg">kg</option>
                                            <option value="oz">oz</option>
                                            <option value="g">g</option>
                                            <option value="count">count</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Protein Content -->
                        <div class="form-section">
                            <h3 class="section-title">üí™ Protein Content</h3>
                            
                            <!-- Calculation Method Toggle -->
                            <div class="calc-toggle">
                                <label class="calc-option">
                                    <input type="radio" name="calc-method" value="per-serving" checked>
                                    <span>Per Serving</span>
                                </label>
                                <label class="calc-option">
                                    <input type="radio" name="calc-method" value="total">
                                    <span>Total Known</span>
                                </label>
                            </div>

                            <!-- Per Serving Method -->
                            <div id="per-serving-inputs" class="calc-inputs">
                                <div class="input-row">
                                    <div class="input-group">
                                        <label>Servings per Container *</label>
                                        <input type="number" id="servings-count" placeholder="30" step="1" min="1">
                                    </div>
                                    <div class="input-group">
                                        <label>Protein per Serving (g) *</label>
                                        <input type="number" id="protein-per-serving" placeholder="24" step="0.1" min="0">
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label>Serving Size</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="serving-size" placeholder="33" step="0.1" min="0">
                                        <select id="serving-unit">
                                            <option value="g">g</option>
                                            <option value="scoop">scoop</option>
                                            <option value="oz">oz</option>
                                            <option value="cup">cup</option>
                                            <option value="tbsp">tbsp</option>
                                            <option value="piece">piece</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Total Known Method -->
                            <div id="total-inputs" class="calc-inputs hidden">
                                <div class="input-group">
                                    <label>Total Protein in Container (g) *</label>
                                    <input type="number" id="total-protein" placeholder="720" step="1" min="0">
                                </div>
                            </div>

                            <!-- Calculated Total -->
                            <div class="calculated-box" id="calculated-box">
                                <div class="calc-row">
                                    <span>Total Protein:</span>
                                    <strong id="calc-total-protein">-- g</strong>
                                </div>
                                <div class="calc-row highlight">
                                    <span>Cost per Gram:</span>
                                    <strong id="calc-cost-per-gram">$--</strong>
                                </div>
                                <div class="calc-row">
                                    <span>Protein per Dollar:</span>
                                    <strong id="calc-protein-per-dollar">-- g</strong>
                                </div>
                            </div>
                        </div>

                        <!-- Notes -->
                        <div class="form-section">
                            <h3 class="section-title">üìù Notes (Optional)</h3>
                            <div class="input-group">
                                <textarea id="product-notes" placeholder="e.g., Great taste, mixes well, bought at Costco..." rows="2"></textarea>
                            </div>
                        </div>

                        <!-- Community Contribution -->
                        <div class="contribution-toggle">
                            <label class="toggle-label">
                                <input type="checkbox" id="contribute-data">
                                <span class="toggle-slider"></span>
                                <span class="toggle-text">Share anonymously to help other shoppers</span>
                            </label>
                        </div>
                    </div>

                    <div class="step-buttons">
                        <button type="button" class="btn-secondary" id="back-to-step-1">‚Üê Back</button>
                        <button type="button" class="btn-primary" id="add-product-btn">
                            ‚ûï Add Product & Compare
                        </button>
                    </div>

                    <!-- Error Message -->
                    <div id="error-message" class="error-message hidden"></div>
                </div>

                <!-- STEP 3: Comparison Results -->
                <div id="step-3" class="step-content hidden">
                    <!-- Add Another Button -->
                    <button type="button" class="add-another-btn" id="add-another-btn">
                        ‚ûï Add Another Product
                    </button>

                    <!-- Best Value Card -->
                    <div id="best-value-card" class="best-value-card">
                        <div class="best-header">üèÜ Best Value</div>
                        <div class="best-product" id="best-product-name">--</div>
                        <div class="best-brand" id="best-product-brand"></div>
                        <div class="best-stats">
                            <div class="best-stat">
                                <span class="stat-label">Cost/gram</span>
                                <span class="stat-value" id="best-cost-per-gram">--</span>
                            </div>
                            <div class="best-stat">
                                <span class="stat-label">Protein/$1</span>
                                <span class="stat-value" id="best-protein-per-dollar">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats Row -->
                    <div class="quick-stats">
                        <div class="quick-stat">
                            <span class="qs-value" id="total-products">0</span>
                            <span class="qs-label">Products</span>
                        </div>
                        <div class="quick-stat">
                            <span class="qs-value" id="diversity-count">0</span>
                            <span class="qs-label">Sources</span>
                        </div>
                        <div class="quick-stat">
                            <span class="qs-value" id="savings-percent">--%</span>
                            <span class="qs-label">Savings</span>
                        </div>
                    </div>

                    <!-- Diversity Card -->
                    <div id="diversity-card" class="diversity-card">
                        <div class="diversity-header">üåà Protein Diversity</div>
                        <div class="diversity-sources" id="diversity-sources">
                            <!-- Filled dynamically -->
                        </div>
                        <div class="diversity-tip" id="diversity-tip">Add products from different sources for better nutrition</div>
                    </div>

                    <!-- Products List -->
                    <div class="products-list-card">
                        <div class="list-header">
                            <h3>üìä All Products</h3>
                            <div class="list-actions">
                                <select id="sort-by" class="sort-select">
                                    <option value="cost-asc">Best Value First</option>
                                    <option value="cost-desc">Highest Cost First</option>
                                    <option value="protein-desc">Most Protein/$</option>
                                    <option value="name-asc">Name A-Z</option>
                                </select>
                                <button id="clear-all-btn" class="clear-btn">üóëÔ∏è</button>
                            </div>
                        </div>
                        <div class="products-list" id="products-list">
                            <!-- Filled dynamically -->
                        </div>
                    </div>
                </div>
            </aside>

            <!-- RIGHT: VISUALIZATION -->
            <section class="viz-section" id="viz-section">
                <div class="viz-container">
                    <div class="chart-placeholder" id="chart-placeholder">
                        <div class="placeholder-icon">üìä</div>
                        <p>Add products to see comparison chart</p>
                        <small>Visualize protein value across all your products</small>
                    </div>
                    <canvas id="comparison-chart" class="hidden"></canvas>
                </div>
                
                <!-- Info Cards -->
                <div class="info-cards">
                    <div class="info-card">
                        <h3>üí° Pro Tips</h3>
                        <ul class="tips-list">
                            <li><strong>Bulk buying?</strong> Compare $/gram across sizes</li>
                            <li><strong>Whey Isolate:</strong> More protein per scoop, less lactose</li>
                            <li><strong>Plant proteins:</strong> Combine sources for complete amino acids</li>
                            <li><strong>Whole foods:</strong> Often cheaper than powders!</li>
                        </ul>
                    </div>
                    
                    <div class="info-card">
                        <h3>üéØ How to Use</h3>
                        <ol class="how-to-list">
                            <li>üì∑ Take photos of product & nutrition label</li>
                            <li>‚úèÔ∏è Enter price and protein info</li>
                            <li>üìä Compare cost per gram instantly</li>
                            <li>üèÜ Find the best value!</li>
                        </ol>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Product Detail Modal -->
    <div id="product-modal" class="modal hidden">
        <div class="modal-content">
            <button type="button" class="modal-close" id="close-modal">‚úï</button>
            <div class="modal-body" id="modal-body">
                <!-- Filled dynamically -->
            </div>
        </div>
    </div>

    <!-- Chart.js for visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script src="app.js"></script>
    
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .catch(err => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>
